---
title: 数组
---


#### 创建和初始化数组

有多种方式创建数组，如下示例所示：

```sh
$arr1 = 1,2,3     # 用逗号分割元素
$arr2 = 1..3    #  创建1~3的数组，元素是1 2 3
$arr3 = @(1,2,3)  # 使用@()
$arr4 = @(0)  # 0个元素的空数组

$arr5=@('hello','world') # 元素为字符串的数组

$arr6=@('hello','world',1,2,3) # 元素的类型不需要相同
```


#### 访问数组元素

```
$arr = @(1,2,3,4,5,6)
$arr  # 打印数组，分行输出 1 2 3
$arr[0]   # 索引位置0也就是第1个元素 1

$arr[-1]   # 最后一个元素
$arr[-2]   # 倒数第二个元素

$arr[1..4]  #  第2到第5个元素  2 3 4 5
$arr[1,4]  #  第2个和第5个元素  2 5

$a[-3..-1]   # 最后3个元素  4 5 6 
$a[-1..-3]   #  最后3个元素  6 5 4  ，注意与上一行的区别
```


#### 修改数组

```sh
$arr = @(1,2,3,4,5,6)
$arr.SetValue(22,1) #   将索引位置1的值改为22
$arr[1]  # 22
```

可以使用 += 运算符将元素添加到数组：

```sh
$a = @(1..4)
$a += 5
$a  # 1 2 3 4 5
```

#### 数组的长度

使用数组的length和count属性得到数组的长度。

```sh
$arr = 1..9
$arr.length   #  9
$arr.count #   9 
```

#### 合并两个数组

```sh
$arr1 = 1,2
$arr2 = 3,4
$arr = $arr1 + $arr2
```

###   迭代和筛选数组

使用foreach()函数迭代数组。

```sh
$arr = 1..9
foreach ($element in $arr) {
  $element    # 依次输出1-9
}
```

使用where{} 筛选数组，通过传递一个表达式，筛选出值为true或可以视为true的元素。

一般而言，如果表达式得到的结果是0，则视为false。

例如，筛选所有奇数元素：

```
(0..9).Where{ $_ % 2 }
```

这里$_指代每次遍历的元素。

再比如，筛选出非空元素：

```sh
('hi', '', 'there').Where({$_.Length})
```


###   字典
字典是一种键值对的映射，有些说法也叫哈希表。

使用@符号加花括号创建一个字典：
```
$data=@{a = 1;b=2}
```

如下示例访问字典的元素：

```
$data['a']   # 括号加引号访问键的值
$data.a  # 直接使用点号访问键的值
$data.keys    # 返回所有键
$data.values   # 返回所有值
```

如下示例对字典进行增删改查：

```sh
$data.add('c',1)    # 添加键c，值为1
$data['d']=4   # 添加键d，值为4
$data.containskey('d') # 查找哈希表的键是否存在
$data.remove('d')  #根据键删除元素
```


# 对象

在powershell中，一切皆对象。


## 查看对象成员

使用如下命令查看对象的成员：

```sh
get-member  $obj
```

## 筛选

Where-Object 脚本块使用特殊的变量“$_”来引用管道中的当前对象。例如：

```sh
get-service | where-object {$_.Name -Match "^Wp.*"}
```


